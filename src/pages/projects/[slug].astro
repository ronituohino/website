---
import Layout from "@layouts/Layout.astro";
import { projects } from "./projects";

import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

export function getStaticPaths() {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { slug } = Astro.params;
const { project } = Astro.props;

type ImagesObject = { [key: string]: Function };
const allImages = import.meta.glob<{ default: ImageMetadata }>(
  "./**/*.{jpeg,jpg,png,gif}"
) as ImagesObject;

let images: ImagesObject = {};
Object.entries(allImages).forEach(([key, func]) => {
  const [_, project, image] = key.split("/");
  if (project === slug) {
    images[image] = func;
  }
});
console.log(project.technologies);
---

<Layout
  title=`${project.title} | Roni Tuohino`
  description={project.seo.description}
>
  <main id="content">
    <h1>{project.title}</h1>
    <h2>{project.organization} | {project.year}</h2>
    {
      project.technologies.map((tech) => {
        <div>{tech}</div>;
      })
    }
    <p class="description">{project.description}</p>
  </main>

  <style>
    main {
      padding: 1rem;
    }
  </style>
</Layout>
